<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body onload="userUpdate()">
		<div><input type="hidden" id="id" name="uid"></div>
		<div>用户名称：<input type="text" id="uname" name="uname"></div>
		<div>用户密码：<input type="text" id="upwd" name="upwd"></div>
		<div>用户邮箱：<input type="text" id="email" name="email"></div>
		<div>用户电话：<input type="text" id="phone" name="phone"></div>
		<div>用户头像：<input type="text" id="avatar" name="avatar"></div>
		<div>真实姓名：<input type="text" id="user_name" name="user_name"></div>
		<div>用户性别：<input type="radio" id="man" name="gender" value=1>男
			<input type="radio" id="women" name="gender" value=0>女
			<input type="radio" id="un" name="gender" value="null">不详
		</div>
		<input type="button" value="修改" onclick="update()">
	</form>
	<script>
		function update(){
			var xhr=new XMLHttpRequest();
			xhr.onreadystatechange=function(){
				if(xhr.readyState==4&&xhr.status==200){
					var result=xhr.responseText;
				}
			}
			xhr.open('post',"/myPro/userupdate",true);
			var genger="";
			if(man.checked){
				genger=1;
			}if(women.checked){
				gender=0
			}
			if(un.checked){
				gender="null"
			}
			var formdata="uid="+uid.value+"&uname="+uname.value+"&upwd="+upwd.value+"&email="+email.value+"&phone="+phone.value+"&avatar="+avatar.value+"&user_name="+user_name.value+"&gender="+gender;
			//修改请求头，可以发送任意文本
			xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			xhr.send(formdata);
		}
		function userUpdate(){
			//获取URlde 参数UID
			var urlParams=new URLSearchParams(location.search);
			var uid=urlParams.get("uid");
			//console.log(uid);
			id.value=uid;
			var xhr=new XMLHttpRequest();
			xhr.onreadystatechange=function(){
				if(xhr.readyState==4&&xhr.status==200){
					var result=xhr.responseText;
					//console.log(result);
					var arr=JSON.parse(result);
						
						//console.log(uid);
						uname.value=arr[uid].uname;
						upwd.value=arr[uid].upwd;
						email.value=arr[uid].email;
						phone.value=arr[uid].phone;
						avatar.value=arr[uid].avatar;
						user_name.value=arr[uid].user_name;
						if(arr[uid].gender==1){
							man.checked="男";
						}
						if(arr[uid].gender==0){
							women.checked="女";
						}else{
							un.checked="不详";
						}
						
				}
			}
			xhr.open('get',"/myPro/userUpdate?uid=" + uid,true);
			xhr.send(null);
		}
	</script>
</body>
</html>